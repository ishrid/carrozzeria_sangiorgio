{# CarrozzeriaSanGiorgio/templates/index.html #}
{% extends 'base.html' %}
{% load static %} 

{% block title %}Carrozzeria San Giorgio | Contatti{% endblock %}

{% block content %}
 
  <head>
      
    <meta name="description" content="Around - Multipurpose Bootstrap HTML Template">
    <meta name="keywords" content="bootstrap, business, corporate, coworking space, services, creative agency, dashboard, e-commerce, mobile app showcase, saas, multipurpose, product landing, shop, software, ui kit, web studio, landing, light and dark mode, html5, css3, javascript, gallery, slider, touch, creative">
    <meta name="author" content="Heich One">
 
      
    <!-- Vendor styles -->
    <link rel="stylesheet" media="screen" href="{% static 'vendor/leaflet/dist/leaflet.css' %}">
     
 
  </head>

 
 
      <!-- Hero -->
      <section class="position-relative pt-md-2 pt-lg-3 pt-xl-3 pb-5 pb-lg-0">
        <div class="position-absolute top-0 start-0 w-100 bg-secondary d-none d-lg-block" style="height: 792px; margin: -1px 0 0 -1px; background-size: 75px 75px; background-image: linear-gradient(to right, var(--ar-gray-200) 1px, transparent 1px), linear-gradient(to bottom, var(--ar-gray-200) 1px, transparent 1px);"></div>
        <div class="position-absolute top-0 start-0 w-100 h-100 bg-secondary d-lg-none" style="margin: -1px 0 0 -1px; background-size: 75px 75px; background-image: linear-gradient(to right, var(--ar-gray-200) 1px, transparent 1px), linear-gradient(to bottom, var(--ar-gray-200) 1px, transparent 1px);"></div>
        <div class="container position-relative z-2 pt-5 pb-2 pb-sm-3 pb-lg-0">
          <div class=" pt-5 mt-3 mt-sm-4 mb-md-3 mb-lg-4 mb-xl-5  "  >
             <!-- Breadcrumb -->
              <nav aria-label="breadcrumb">
                <ol class="pt-lg-3 pb-lg-4 pb-2 breadcrumb">
                  <li class="breadcrumb-item">
                    <a href="/">Home</a>
                  </li>
                  <li class="breadcrumb-item active" aria-current="page">Contatti</li>
                </ol>
              </nav>
            <h1 class="display-3 pb-1 pb-sm-2 pb-md-3 text-md-center">Il contatto giusto per ogni esigenza</h1>
            <p class="fs-lg pb-1 pb-sm-2 pb-md-3 text-md-center">Una telefonata, una mail o un semplice messaggio WhatsApp. Qualunque sia la tua esigenza, ti rispondiamo in tempi rapidi e con la massima chiarezza.</p>
          </div>

           
           
           <!-- Mappa al posto dell'immagine -->
<div class="rounded overflow-hidden z-2" style="-webkit-clip-path: url(#shape); clip-path: url(#shape);">
  <div class="ratio ratio-21x9 d-none d-md-block">
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2771.3052148895185!2d8.902655!3d46.0051!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47842d69dc462793%3A0xc08b4ff3c927c1c2!2sCarrozzeria%20San%20Giorgio%20SA!5e0!3m2!1sit!2sch!4v1765362758071!5m2!1sit!2sch"
      style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
  </div>
  <div class="ratio ratio-16x9 d-md-none">
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2771.3052148895185!2d8.902655!3d46.0051!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x47842d69dc462793%3A0xc08b4ff3c927c1c2!2sCarrozzeria%20San%20Giorgio%20SA!5e0!3m2!1sit!2sch!4v1765362758071!5m2!1sit!2sch"
      style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
  </div>



 



</div>

        </div>
      </section>

 
      
 
       
       


      <!-- Page content-->
      <section class="container pt-md-5 pb-lg-2 pb-xl-4 py-xxl-5 my-5">

         
 
        <!-- Contact details -->
        
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4 pt-2">

            <!-- Address -->
            <div class="col pb-2">
              <h4 class="mb-lg-4">Indirizzo</h4>
              <p class="fs-lg fw-medium pb-md-3 mb-3">Via Mulino della Bolla 5<br>6982 Agno, Svizzera</p>
               

                   
                        <a class="btn btn-secondary btn-sm btn-instagram d-inline-flex align-items-center gap-2 rounded-pill"
   href="https://www.instagram.com/carrozzeria_san_giorgio?igsh=Mm9naXc5Y3A1cWxm"
   target="_blank" aria-label="Instagram">

    <i class="ai-instagram"></i>
    <span>Instagram</span>
</a>

            </div>

            <!-- Phone -->
            <div class="col pb-2">
              <h4 class="mb-lg-4">Telefono</h4>
              <ul class="list-unstyled mb-0">
                <li class="pb-1 mb-2">
                  <span class="d-block fs-sm text-body-secondary mb-1">Fisso</span>
                  <a class="nav-link fs-lg p-0" href="tel:+178632256033">091 605 21 44</a>
                </li>
                
                  
                 
              </ul>
            </div>

            <!-- Schedule -->
            <div class="col pb-2">
              <h4 class="mb-lg-4">Orari di apertura</h4>
              <ul class="list-unstyled mb-0">
                <li class="pb-1 mb-2">
                  <span class="d-block fs-sm text-body-secondary mb-1">Lunedì - Venerdì</span>
                  <div class="d-flex align-items-center">
                    <span class="text-nav fs-lg fw-medium">07:30</span>
                    <span class="border-top mx-4" style="width: 36px; height: 1px;"></span>
                    <span class="text-nav fs-lg fw-medium">12:00</span>
                  </div>
                  <div class="d-flex align-items-center mt-2">
                    <span class="text-nav fs-lg fw-medium">13:30</span>
                    <span class="border-top mx-4" style="width: 36px; height: 1px;"></span>
                    <span class="text-nav fs-lg fw-medium">17:30</span>
                  </div>
                </li>
                <li class="pb-1 mb-2">
                  <span class="d-block fs-sm text-body-secondary mb-1">Sabato</span>
                  <div class="d-flex align-items-center">
                    <span class="text-nav fs-lg fw-medium">Solo su appuntamento</span> 
                  </div>
                </li>
                
              </ul>
            </div>

            <!-- Email -->
            <div class="col pb-2">
              <h4 class="mb-lg-4">Email</h4>
              <a class="nav-link fs-lg p-0" href="mailto:carr.sangiorgio@ticino.com">carr.sangiorgio@ticino.com</a>
            </div>
          </div>
        
      </section>

 
 

 <section class="container pb-5 mb-2 mb-md-4 mb-lg-5">
    <div class="row">
        <div class="col-lg-6 mb-5 mb-lg-0">
             
            <div class="ratio ratio-4x3 rounded-3 overflow-hidden">
  <img src="{% static 'img/cta/cont2.jpg' %}" 
       alt="Mappa o immagine di copertura" 
       class="w-100 h-100 object-fit-cover">
</div>

        </div>

        <div class="col-lg-6 ps-lg-5">
    <h2 class="h3 mb-4">Inviaci un messaggio</h2>

    <form method="post" class="row g-4 needs-validation" novalidate>
        {% csrf_token %}

        <div class="col-sm-6">
            <label class="form-label fw-bold" for="{{ form.nome.id_for_label }}">
                {{ form.nome.label }}
            </label>
            {{ form.nome }}
            {{ form.nome.errors }}
        </div>

        <div class="col-sm-6">
            <label class="form-label fw-bold" for="{{ form.email.id_for_label }}">
                {{ form.email.label }}
            </label>
            {{ form.email }}
            {{ form.email.errors }}
        </div>

        <div class="col-sm-6">
            <label class="form-label fw-bold" for="{{ form.telefono.id_for_label }}">
                {{ form.telefono.label }}
            </label>
            {{ form.telefono }}
        </div>

        <div class="col-sm-6">
            <label class="form-label fw-bold" for="{{ form.tipo_richiesta.id_for_label }}">
                {{ form.tipo_richiesta.label }}
            </label>
            {{ form.tipo_richiesta }}
        </div>

        <div class="col-12">
            <label class="form-label fw-bold" for="{{ form.messaggio.id_for_label }}">
                {{ form.messaggio.label }}
            </label>
            {{ form.messaggio }}
            {{ form.messaggio.errors }}
        </div>

        <div class="col-12 pt-2">
            <button class="btn btn-lg btn-primary" type="submit">
                Invia richiesta
            </button>
        </div>
    </form>
</div>

    </div>
</section>
  
 

    <!-- Vendor scripts: JS libraries and plugins -->
    <script src="{% static 'vendor/leaflet/dist/leaflet.js' %}"></script>

{# Se hai bisogno di JS specifico per la validazione del form o per Leaflet, mettilo qui. #}
{# Altrimenti, non è necessario per questo layout. #}
{# Se hai deciso di usare Leaflet, il suo JS deve essere in base.html o qui, e la mappa deve essere inizializzata. #}
<script>
    // Esempio per la validazione del form Bootstrap (se non gestita da Django Forms)
    (function () {
        'use strict'
        var forms = document.querySelectorAll('.needs-validation')
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
    })()

    // Logica per precompilare il messaggio se si arriva da pagina veicolo/servizio
    document.addEventListener('DOMContentLoaded', function() {
        const messageField = document.getElementById('id_messaggio');
        const urlParams = new URLSearchParams(window.location.search);
        
        const veicoloRiferimento = urlParams.get('veicolo_riferimento');
        const servizioRiferimento = urlParams.get('servizio'); // Dal link Servizi

        let prefillMessage = '';

        if (veicoloRiferimento) {
            // Nota: per ottenere marca/modello del veicolo, dovresti passarlo dalla view di dettaglio veicolo,
            // oppure fare una chiamata AJAX qui per recuperarlo se il veicolo_riferimento è solo l'ID.
            // Per ora, assumo che tu passi il nome completo del veicolo nel parametro URL 'messaggio'
            // come fatto nel template veicoli_detail.html: `?servizio={{ servizio.nome|urlencode }}`
            // ... ma per i veicoli, si usa 'veicolo_riferimento', quindi il nome andrebbe passato separatamente o recuperato.
            // Per semplicità, qui useremo il messaggio pre-compilato dal template del veicolo.
            // Se arrivi da vendita, il textarea è già compilato via Django.
        } else if (servizioRiferimento) {
            prefillMessage = `Sono interessato al servizio di ${decodeURIComponent(servizioRiferimento)}. Potreste fornirmi maggiori informazioni?`;
        }

        // Se il messaggio non è già precompilato da Django, usa quello generato qui
        if (messageField.value.trim() === '' && prefillMessage !== '') {
            messageField.value = prefillMessage;
        }
    });
</script>

  

{% endblock %}

{% block extra_js %}
{# Se hai bisogno di JS specifico per la validazione del form o per Leaflet, mettilo qui. #}
<script>
    // Validazione del form Bootstrap
    (function () {
        'use strict'
        var forms = document.querySelectorAll('.needs-validation')
        Array.prototype.slice.call(forms)
            .forEach(function (form) {
                form.addEventListener('submit', function (event) {
                    if (!form.checkValidity()) {
                        event.preventDefault()
                        event.stopPropagation()
                    }
                    form.classList.add('was-validated')
                }, false)
            })
    })();

    // Logica per pre-compilare il messaggio se si arriva da un'altra pagina
    document.addEventListener('DOMContentLoaded', function() {
        const messageField = document.getElementById('id_messaggio');
        if (!messageField) return; // Esce se il campo non esiste

        const urlParams = new URLSearchParams(window.location.search);
        const servizioRiferimento = urlParams.get('servizio');
        const veicoloRiferimento = urlParams.get('veicolo_riferimento'); // Aggiunto per completezza

        let prefillMessage = '';

        if (veicoloRiferimento) {
            prefillMessage = `Sono interessato al veicolo con riferimento: ${decodeURIComponent(veicoloRiferimento)}. Vorrei avere maggiori informazioni.`;
        } else if (servizioRiferimento) {
            prefillMessage = `Sono interessato al servizio di "${decodeURIComponent(servizioRiferimento)}". Potreste fornirmi maggiori informazioni?`;
        }

        if (messageField.value.trim() === '' && prefillMessage !== '') {
            messageField.value = prefillMessage;
        }
    });
</script>
{% endblock %}